<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Detalle Evento {{ evento.id_evento }}</title>
  <style>
    body { font:14px Arial, sans-serif; margin:20px; }
    section { margin-bottom:20px; }
    h2 { margin-top:30px; }
    table { width:100%; border-collapse:collapse; margin-top:10px; }
    th, td { border:1px solid #ccc; padding:6px; }
    th { background:#f0f0f0; }
    label { display:block; margin-top:8px; }
    input[type=text] { padding:4px; width:300px; }
    button { margin:6px; padding:6px 12px; }
    .error { color:red; }
    a { text-decoration:none; color:#0066cc; }
  </style>
</head>
<body>
  <h1>Detalle del Evento {{ evento.id_evento }}</h1>

  <!-- Secci√≥n: Datos b√°sicos del evento -->
  <section>
    <p><strong>Fecha/Hora:</strong> {{ evento.fecha_hora }}</p>
    <p><strong>Ubicaci√≥n:</strong> Epicentro ({{ evento.ubicacion.epicentro }}) ‚Äì 
       Hipocentro ({{ evento.ubicacion.hipocentro }} km)</p>
    <p><strong>Magnitud:</strong> {{ evento.magnitud }}</p>
    <p><strong>Clasificaci√≥n:</strong> {{ evento.clasificacion }}</p>
    <p><strong>Alcance:</strong> {{ evento.alcance }}</p>
    <p><strong>Origen:</strong> {{ evento.origen }}</p>
    <p><strong>Estado Actual:</strong> {{ evento.estado.nombre }}</p>
  </section>

  {% if error %}
    <p class="error">{{ error }}</p>
  {% endif %}

  <!-- Secci√≥n: Modificar datos del evento -->
  <section>
    <h2>Modificar Datos del Evento</h2>
    <form method="post" action="{{ url_for('detalle', event_id=evento.id_evento) }}">
      <input type="hidden" name="accion" value="update">
      <label>Magnitud (n√∫mero): <input name="magnitud" value="{{ evento.magnitud }}"></label>
      <label>Alcance: <input name="alcance" value="{{ evento.alcance }}"></label>
      <label>Origen (tipo): <input name="origen" value="{{ evento.origen.tipo }}"></label>
      <button type="submit" onclick="return confirm('¬øGuardar cambios de magnitud/alcance/origen?')">
        Guardar Cambios
      </button>
    </form>
  </section>

  <!-- Secci√≥n: Acciones de revisi√≥n -->
  <section>
    <h2>Acciones de Revisi√≥n</h2>
    <form method="post" action="{{ url_for('detalle', event_id=evento.id_evento) }}">
      <button name="accion" value="confirm" 
              onclick="return confirm('¬øConfirmar evento?')">
        ‚úî Confirmar Evento
      </button>
      <button name="accion" value="reject" 
              onclick="return confirm('¬øRechazar evento?')">
        ‚úñ Rechazar Evento
      </button>
      <button name="accion" value="expert" 
              onclick="return confirm('¬øSolicitar revisi√≥n a experto?')">
        üïµ Solicitar Revisi√≥n a Experto
      </button>
    </form>
  </section>

  <!-- Secci√≥n: Opciones adicionales -->
  <section>
    <h2>Opciones Adicionales</h2>
    <form method="get" action="{{ url_for('mostrar_mapa', event_id=evento.id_evento) }}">
      <button type="submit" onclick="return confirm('¬øVisualizar mapa?')">üó∫ Mostrar Mapa</button>
    </form>
  </section>

  <!-- Secci√≥n: Series Temporales y Muestras -->
  <section>
    <h2>Series Temporales y Muestras</h2>
    {% if evento.series_temporales %}
      {% for s in evento.series_temporales %}
        <h3>Estaci√≥n: {{ s.estacion }} (Registro: {{ s.fecha_hora_registro }})</h3>
        <table>
          <thead>
            <tr>
              <th>Tiempo</th><th>Velocidad (km/s)</th><th>Frecuencia (Hz)</th><th>Longitud (km)</th>
            </tr>
          </thead>
          <tbody>
            {% for m in s.muestras %}
              <tr>
                <td>{{ m.fecha_hora_muestra }}</td>
                <td>{{ m.velocidad_onda }}</td>
                <td>{{ m.frecuencia_onda }}</td>
                <td>{{ m.longitud_onda }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      {% endfor %}
    {% else %}
      <p>No hay series temporales registradas.</p>
    {% endif %}
  </section>

  <!-- Secci√≥n: Historial de Estados -->
  <section>
    <h2>Historial de Estados</h2>
    {% if evento.cambios %}
      <ul>
      {% for c in evento.cambios %}
        <li>{{ c }}</li>
      {% endfor %}
      </ul>
    {% else %}
      <p>No hay cambios de estado registrados.</p>
    {% endif %}
  </section>

  <p><a href="{{ url_for('index') }}">‚Üê Volver al Listado</a></p>
</body>
</html>
